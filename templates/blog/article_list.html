{% extends 'base.html' %}
{% load static %}

{% block title %}Inicio - Blog Musical{% endblock %}

{% block content %}
<!-- Sección del carrusel de héroe -->
<!-- Se agrega una clase personalizada 'hero-container' para controlar el tamaño máximo del carrusel -->

<style>
    /* Estilos para el carrusel */
    /* Contenedor para controlar el tamaño del carrusel */
    .hero-section {
        max-width: 1000px;
        /* Tamaño máximo para el carrusel */
        margin: 0 auto;
        /* Centrar el carrusel */
        margin-top: -2rem;
        margin-bottom: -3rem;
    }

    /* Contenedor de la imagen del carrusel */
    .carousel-image-container {
        height: 580px;
        /* Altura fija deseada */
        overflow: hidden;
        /* Oculta cualquier parte de la imagen que se salga */
    }

    /* Estilos de la imagen dentro del carrusel */
    .carousel-image-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        /* Recorta y centra la imagen para que llene el contenedor */

    }

    .hero-section .hero-caption {
        top: 50%;
        transform: translateY(-75%);
        left: 50%;

    }

    .hero-section .hero-caption h5 {
        font-size: 2.5rem;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 10);
    }

    .hero-section .hero-caption p {
        font-size: 1.2rem;

    }

    /* Estilos para truncar el texto a 3 líneas */
    .text-truncate-3-lines {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        /* Limita el texto a 3 líneas */
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
        /* Añade puntos suspensivos al final */
    }

    /* Estilo personalizado para el texto del artículo */
    .article-text {
        /* Puedes ajustar otras propiedades aquí, como el tamaño de la fuente o el color */
    }

    .card-img-top-container {
        height: 200px;
        /* Altura fija para las imágenes de la tarjeta */
        overflow: hidden;
        position: relative;
    }

    .card-img-top-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
</style>



<header class="hero-section text-center py-5">
    <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
            {% for article in articles|slice:"3" %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
                <!-- Se agrega un contenedor para la imagen con la clase 'carousel-image-container' -->
                <div class="carousel-image-container">
                    <!-- Usar una imagen de marcador de posición si no hay imagen destacada -->
                    <img src="{% if article.featured_image %}{{ article.featured_image.url }}{% else %}{% static 'img/placeholder.jpg' %}{% endif %}"
                        class="d-block w-100" alt="{{ article.title }}">
                </div>
                <div class="carousel-caption d-none d-md-block text-white">
                    <div class="hero-caption">
                        <span class="fw-bold text-dark-orange">Autor {{ article.user.username }}</span>
                        <h5>{{ article.title }}</h5>
                        <a href="{% url 'blog:article_detail' article.slug %}" class="btn btn-orange">Leer más</a>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="carousel-item active">
                <div class="carousel-image-container">
                    <img src="{% static 'img/placeholder.jpg' %}" class="d-block w-100"
                        alt="No hay artículos destacados">
                </div>
                <div class="carousel-caption d-none d-md-block text-white">
                    <div class="hero-caption">
                        <h5>No hay artículos disponibles</h5>
                        <p>¡Crea tu primer artículo para empezar!</p>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Anterior</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Siguiente</span>
        </button>
    </div>
</header>

<!-- Contenido principal con los artículos -->
<main class="container my-5">
    <h2 class="text-center mb-4">LO MÁS VISTO</h2>
    <div class="row row-cols-1 row-cols-md-3 g-4">
        {% for article in articles %}
        <div class="col">
            <div class="card h-100 border-0 shadow-sm rounded-3 overflow-hidden">
                <!-- Contenedor para la imagen con relación de aspecto 4:3 -->
                <div class="card-img-top-container">
                    <img src="{% if article.featured_image %}{{ article.featured_image.url }}{% else %}{% static 'img/placeholder.jpg' %}{% endif %}"
                        class="card-img-top" alt="{{ article.title }}">
                </div>

                <div class="card-body d-flex flex-column">
                    <small class="text-grey mb-2">Autor | {% for category in article.category.all %}{{ category.name
                        }}{% endfor %}</small>
                    <h5 class="card-title fw-bold">{{ article.title }}</h5>
                    <p class="card-subtitle mb-3 text-grey">
                        Por <span class="fw-bold text-orange">{{ article.user.username }}</span> | {{
                        article.created_at|date:"d M, Y" }}
                    </p>
                    <!-- Se agrega una clase personalizada 'article-text' para establecer una altura máxima y truncar el texto -->
                    <p class="card-text text-truncate-3-lines article-text"> {{ article.content }}</p>
                    <div class="mt-auto">
                        <a href="{% url 'blog:article_detail' article.slug %}"
                            class="btn btn-orange w-100 fw-bold">Seguir leyendo</a>
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12 text-center">
            <p class="lead">No hay artículos disponibles.</p>
        </div>
        {% endfor %}
    </div>
</main>


<!-- Scripts de Bootstrap y JQuery -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}